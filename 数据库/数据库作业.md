## 第七章作业

*170617 17373126 刘萱*

**1、试述数据库的设计过程**

 答：1）需求分析；2）概念结构设计；3）逻辑结构设计；4）数据库物理设计；5）数据库实施；6）数据库运行和维护。



**2、现有一个学校信息系统。**

**该学校有多个系，描述系的信息有：系编号、系名**

**每个系有多名教师，描述教师的信息有：教师编号、教师名、研究领域。每个教师只能属于一个系，一个系可以有多个老师**

**每个系都有一个教师作为系主任，每个教师只能在一个系当系主任**

**每个系有多个班级，描述班级的信息有：班级编号、班级名、专业，每个班级只属于一个系。**

**每个班级有多个学生，每个学生只能属于一个班级。描述学生的信息有：学号、姓名、年龄、性别**

**每个班级都有一个学生担任班长，一个学生只能在一个班级担任班长。**

**有的学生担任指导员，一个指导员可以管理多个学生，每个学生只能有一个指导员。**

**一个系可以有多门课程，每门课可以在多个系开课。描述课程的信息有：课程编号、课程名、学时、学分**

**一个教师可以讲多门课，一门课可以被多个教师讲。一个学生可以选择多门课，一门课可以被多个学生学。但当一个学生选定一门课时，就有一个确定的老师。一个学生选定的每一门课程都有一个成绩。**

**要求：**

**（1）画出ER图**

![](C:\Users\yusong\Desktop\Untitled Diagram.jpg)

**（2）将其转换为关系模式，并规范化到`3NF`。**

**（3）指出每个关系模式的主码和外码**

系（<u>系编号</u>，系名）

教师（<u>教师编号</u>，教师名，研究领域）外码：系编号

班级（<u>班级编号</u>，班级名，专业）外码：系编号

学生（<u>学号</u>，姓名，年龄，性别， 班长）外码：班级编号

课程（<u>课程编号</u>，课程名，课时，学分）外码：系编号

选课（学生，<u>课程编号</u>，教师，成绩）外码：学号

*有下划线的为主码



## 第九章作业

**1、试述`RDBMS`查询处理的主要步骤**

 答：`RDMBS`查询处理可分为查询分析、查询检查、查询优化和查询执行四个阶段 。

**2、对学生-课程数据库有如下查询：**

**`SELECT Cname FROM Student, Course, SC`**

**`WHERE Student.Sno= Sc. Sno AND SC.Cno=Course.Cno AND Student.Sdept = ‘IS’`**

**试画出关系代数表示的语法树，并对其进行优化处理，得到优化后的语法树。**

 ![](C:\Users\yusong\Desktop\Untitled Diagram (1).jpg)



## 第十章作业

**1、 试述事务的概念及事务的四个特性。恢复技术可以保证事务的哪些特性？**

答：所谓事务是用户定义的一个数据库操作序列，这些操作要么全做，要么全不做，只一个不可分割的工作单位。 

事务具有4个特性：原子性，一致性，隔离性和持续性，这4 个特性简称ACID特性。恢复技术可以保证事务的原子性，一致性与持续性。

**2、 数据库恢复的基本技术有哪些？**

答：恢复机制涉及的两个关键问题是：如何建立冗余数据，以及如何利用这些冗余数据实施数据库恢复。建立冗余数据最常用的技术是数据转储和登记日志文件。通常在一个数据库系统中，这两种方法是一起使用的。 

数据转储是数据库恢复中采用的基本技术。所谓转储即数据库管理员定期地将整个数据库复制到磁带、磁盘或其他存储介质上保存起来的过程。这些备用的数据成为后备副本或后援副本。 

日志文件是用来记录事务对数据库的更新操作的文件。不同数据库系统采用的日志文件格式并不完全一样。概括起来日志文件主要有两种格式：以记录为单位的日志文件和以数据块为单位的日志文件。

**3、 什么是日志文件，登记日志日志文件时，为什么必须先写日志文件，后写数据库？**

答：日志文件是用来记录事务对数据库的更新操作的文件。

把对数据的修改写到数据库中和把表示这个修改的日志记录写到日志文件中是两个不同的操作。有可能在这两个操作之间发生故障，即这两个写操作只完成了一个。

如果先写了数据库修改，而在运行记录中没有登记这个修改，则以后就无法回复这个修改了。如果先写日志文件，但没有修改数据库，在恢复时不过是多执行一次`UNDO`操作，并不会影响数据库的正确性。所以一定要先写日志文件后写数据库。

**4、 数据库运行中可能产生的故障有哪几类，针对不同的故障，试给出恢复的策略和方法**

答：

事务故障是指事务在运行至正常重点前被终止，这时恢复子系统应利用日志文件撤销此事务已对数据库进行的修改。事务故障的恢复是由系统自动完成的，对用户是透明的。系统恢复的步骤是：

（1）反向扫描日志文件，查找该事务的更新操作。

（2）对该事务的更新操作执行逆操作，即将日志目录中“更新前的值”写入数据库。这样，如果记录中是插入操作，则相当于做删除操作（因此时“更新前的值”为空）；若记录中的是删除操作，则做插入操作；若是修改操作，则相当于修改前置代替修改后的值。

（3）继续反向扫描日志文件，查找该事务的其他更新操作，并做同样处理。

（4）如此处理下去，直至读到此事务的开始标记，事务故障恢复就完成了。 

系统故障的恢复是由系统在重新启动时自动完成的，不需要用户干预。系统恢复的步骤是：

（1）正相扫描日志文件（即从头扫描日志文件），找出在故障发生之前已经提交的事务。将其事务标识计入重做队列。同事找出故障发生时尚未完成的食物，将其事务标识记入撤销队列。

（2）对撤销队列中的各个事务进行撤销处理。进行撤销处理的方法是，反向扫描日志文件，对每个撤销事务的更新操作执行逆操作，即将日志记录中“更新前值”写入数据库。

（3）对重做队列中的各个失误进行重做处理。对重做处理的方法是：正向扫描日志文件，最每个崇左市五重新执行日志文件登记的操作，即将日志文件中“更新后的值”写入数据库。

发生介质故障后，磁盘上的物理数据和日志文件被破坏，这是最严重的一种故障，恢复方法是重装数据库，然后崇左已完成的事物。

（1）装入最新的数据库后备副本，是数据库恢复到最近一次转储时的一致性状态。对于动态转储的数据库副本，还需同时装入转储开始时刻的日志文件副本，利用恢复系统故障的方法，才能将数据库恢复到一致性状态。

（2）装入相应的日志文件副本，重做已完成的事务。即首先扫描日志文件，找出故障发生时已提交的事务的标识，将其计入重做队列；然后正向扫描日志文件。对重做队列中的所有事物进行重做处理。即将日志记录中“更新后的值”写入数据库。

**5、 具有检查点的恢复技术有什么优点？**

答：这种技术在日志文件中增加一类新的记录——检查点记录，增加一个重新开始文件，并让恢复子系统在登录日志文件期间动态的维护日志。使用检查点方法可以改善恢复效率。 



## 第十一章作业

**1、并发操作可能会产生哪几类数据不一致？**

 答：并发操作带来的数据不一致性包括丢失修改、不可重复读和读“脏”数据 

**2、什么是封锁？基本的封锁类型有几种？如何用封锁机制保证数据的一致性？**

答：封锁就是事务T在对某个数据对象例如表、记录等操作之前，先向系统发出请求，对其加锁。加锁后事务T就对该数据对象有了一定的控制，在事务T释放它的锁之前，其他的事物不能更新或读取此数据对象。

基本的封锁类型有两种：排他锁（X锁）和共享锁（S锁）

排他锁又称为写锁。若事务T对数据对象A加上X锁，就只允许T读取和修改A，其他事务都不能再对A加任何类型的锁，直到T释放了A上的锁。这就保证了其他事务在T释放A上的锁之前不能读取和修改A。

共享锁又称为读锁。若事务T对数据对象A加上S锁，则事务T可以读A但不能修改A，其他事务只能对A再加S锁，而不能再加X锁，直到T释放了在A上的S锁。这就保证了其他事务可以读A，但在T释放A上的S锁之前不能对A进行任何的修改。

**3、什么是死锁，请给出解决死锁问题的方法。**

答： `T1`在等待`T2`，而`T2`又在等待`T1`的局面，`T1`和`T2`两个事务永远不能劫数，形成死锁。 

通常解除死锁问题的方法是选择一个处理死锁代价最小的事务，将其撤销，释放此事务所持有的所有锁，使其他事务得以继续运行下去。

**4、什么样的调度是正确的调度？怎样得到正确的调度？**

答： 串行调度是正确的。执行结果等价于串行调度的调度也是正确的。这样的调度叫做可串行化调度。可串行性是并发事务正确调度的准则。按这个准则规定，一个给定的并发调度，当且仅当它是可串行化的，才认为是正确调度。 

**5、为什么要引进意向锁？**

  答：意向锁的含义是如果对一个结点加意向锁，则说明该节点的下层结点正在被加锁；对仁义结点加锁是，必须先对它的上层结点加意向锁。引进意向锁是为了提高封锁子系统的效率。



## 第十三章作业

**1、 分布式数据库系统有什么特点？**

答：分布式数据库由一组数据组成，这组数据分布在计算机网络的不同计算机上，网络中的每个节点具有独立处理的能力，可以执行局部应用。同时，每个结点也能通过而网络通信系统执行全局应用。这个定义强调了分布式数据库系统的场地自治性和自治场地之间的协作性。

**2、 试述分布式数据库系统的模式结构和分布透明性的内容**

答：集中式数据库的许多概念和技术，如数据独立性、数据共享和数据冗余、并发控制、完整性、安全性和恢复等，在分布式数据库系统中都有了新的更加丰富的内容。

**3、什么是数据分片？有几种分片方式？为什么要进行数据分片？**

答：关系被划分为几个片段，各个片段存储在不同的结点上。将数据分片，使数据存放的单位不是关系而是片段，这既有利于按照用户的需求较好地组织数据的分布，也有利于控制数据的冗余度。 

分片方式有：水平分片、垂直分片、导出分片、混合分片 

**4、 什么是半连接？在分布式数据库中它有什么作用？**

![image-20191205204646011](C:\Users\yusong\Desktop\image-20191205204646011.png)

​     找出R中能够与S中元组相连接的元组来，类似于在连接之前先做选择和投影。  

